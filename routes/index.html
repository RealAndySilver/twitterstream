<html>
	<body style="font-family: Helvetica;">
		
		<style>
			/*TextColors*/
			.grayText{
				color: #8c8c8c;
			}
			.lightGrayText{
				color: #d2d2d2;
			}
			.greenText{
				color:#85d45e;
			}
			.orangeText{
				color: #fca438;
			}
			.pinkText{
				color: #f17171;
			}
			.darkRedText{
				color: #b20034;
			}
			.darkGray{
				color: #505050;
			}
			.blueText{
				color:#3c9ecb;
			}
			/*End of TextColors*/
			
			.align-right{
				text-align: right;
			}
			.avatarImg{
			    height: 150px;
			    width: 150px;
			    border-radius: 75px;
			}
			
			#bg{
				width:100%;
				height: 100%;
				position: fixed;
				background: ;
				z-index: -1;
				padding: 0;
				margin: 0;
			}
			
			.biggestFont{
				font-size:100px;
			}
			.biggerFont{
				font-size:70px;
			}
			.bigFont{
				font-size:60px;
			}
			.midBigFont{
				font-size:30px;
			}
			.midFont{
				font-size:20px;
			}
			.regularFont{
				font-size:16px;
			}
			.smallFont{
				font-size:10px;
			}
			
			.bottom{
				width:680px; 
				margin:10px auto;
			}
			.card{
				width:330px;
				height: 350px;
				float:left; 
				margin-right:10px;
				margin-bottom: 5px;
				//background: #726a73;
			}
			.cardBottom{
				height:100px; 
				//float:left; 
				margin-top:0px;
			}
			.indMostUsedWordsContanier{
				height: 30px;
				width: 300;
				float: left;
			}
			.keywordsContainer{
				margin-top:10px;
				float: left;
			}
			.cardname{
				font-size:35px; 
				font-weight:bold;
				margin-top:10px;
			}
			.cardsContainer{
				width:680px; 
				margin:10px auto;
				padding: 0 10px;
			}
			.mostUsedWordsContainer{
				width: 680px;
				height: 20px;
				margin: 10px auto;
			}
			.imgContainer{
				float:left; 
				width:150px; 
				height: 200px; 
				margin-top:10px; 
				overflow: hidden;
			}
			.indTps{
				font-size:18px; 
			}
			.indRtps{
				font-size:18px; 
			}
			.indTpsContainer{
				margin-left:-0px;
			}
			.indRtpsContainer{
				margin-left:-0px;
			}
			.italic{
				font-style: italic;
			}
			.justify{
				text-align: justify;
			}
			
			.percent{
				font-size:50px;
				font-weight: bold;
			}
			.retweetNumber{
				font-size:15px; 
				margin-top:0px;
			}
			.rightContainer{
				float:right; 
				width: 170px; 
				height:200px; 
				margin-top:10px; 
				margin-left: 10px;
				color:gray; 
				padding-left:0px;
				//background: #ce5858;
			}
			.rtpsText{
				color:gray;
				font-size:20px; 
				font-weight:0;
			}
			
			.title{
				width:680px; 
				margin:0 auto; 
				margin-top:0px; 
				text-align: left;
			}
			.bold{
				font-weight: bold;
			}
			.totalRetweets{
				font-size: 30px; 
				font-weight: bold;
			}
			
			/*Totals*/
			.totalContainer{
				width:680px; 
				height: 260px;
				margin:20px auto; 
				margin-top: 70px;
				padding: 0 10px;
			}
			.sectionContainer{
				height: 85px;
				width: 680;
				float: left;
			}
			.totalTitleWrapper{
				width:180px;
				height: inherit;
				float: left;
			}
			.totalNumberWrapper{
				width: 500px;
				height: 70px;
				float: left;
			}
			.totalTpsWrapper{
				width: 500px;
				height: 15px;
				float: left;
			}
			
			/*Animations*/
			.pinkAnimation{
				-webkit-transition: all .3s ease;
			    -moz-transition: all .3s ease;
			    -ms-transition: all .3s ease;
			    -o-transition: all .3s ease;
			    transition: all .3s ease;
			}
			.blueAnimation{
				-webkit-transition: all .3s ease;
			    -moz-transition: all .3s ease;
			    -ms-transition: all .3s ease;
			    -o-transition: all .3s ease;
			    transition: all .3s ease;
			}
			.greenAnimation{
				-webkit-transition: all .3s ease;
			    -moz-transition: all .3s ease;
			    -ms-transition: all .3s ease;
			    -o-transition: all .3s ease;
			    transition: all .3s ease;
			}
			.tpsAnimation{
				-webkit-transition: all .3s ease;
			    -moz-transition: all .3s ease;
			    -ms-transition: all .3s ease;
			    -o-transition: all .3s ease;
			    transition: all .3s ease;
			}
			.sectionContainer:hover > .pinkAnimation {
			    background: #db6161;
			    color: white;
			    text-align: center;
			    border-radius: 50px 50px 50px 50px;
			    width: 400px;
			}
			.sectionContainer:hover > .blueAnimation {
			    background: #3c9ecb;
			    color: white;
				text-align: center;
			    border-radius: 50px 50px 50px 50px;
			    width: 400px;			
			}
			.sectionContainer:hover > .greenAnimation {
			    background: #85d45e;
			    color: white;
				text-align: center;
			    border-radius: 50px 50px 50px 50px;
			    width: 400px;		
			}
			.sectionContainer:hover > .tpsAnimation{
				text-align: center;
			    width: 400px;
			}
			
			.totalRetweetsNumber{
				font-size:100px;
			}
			.tweetNumber{
				font-size:30px; 
				margin-top:10px;
			}
			.whiteBackground{
				background: white;
			}
			
		</style>
		
		
		
		
		<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.11.2/moment.min.js"></script>
		<script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
		
		<script>
			var socket = io.connect('http://192.241.187.135:3200');
			//var socket = io.connect('http://localhost:3200');
			var loadOnce = 0;
			var tps = 0;
			var lastTotalObject = {tweets:0, retweets:0};
			var totalObject = {tweets:0, retweets:0};
			var totalArray = [];
			var lastTotalArray = [];
			var percent = 0;
			var total = 0;
			var localData = {};
			function numberWithCommas(x) {
				return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
			}
			socket.on('broadcast', function (data) {
			  
				totalTweets = data.items.map(function(elem){return elem.total.tweets}).reduce(function(prev,current){return prev + current;});
				for (var i =0; i<data.items.length;i++){
					if(!document.getElementById("tweetNumber"+(i+1))){
						document.getElementById("cardsContainer").style.height = (data.items.length/2*350)+'px';
							document.getElementById("cardsContainer").innerHTML += 
							'<div class="card">'+
								'<div class="cardname">'+
									'<span id="cardname'+(i+1)+'"></span>'+
								'</div>'+
								'<div class="imgContainer" style="">'+
										'<img class="avatarImg" id="imgCard'+(i+1)+'"/>'+
								'</div>'+
								'<div class="rightContainer">'+
									'<div id="tweetNumber'+(i+1)+'" class="tweetNumber pinkText"></div>'+
									'<div><small>Times</small></div>'+
									'<div id="retweetNumber'+(i+1)+'" class="retweetNumber darkRedText"></div>'+
									'<div><small>Retweets</small></div>'+
									'<div id="percent'+(i+1)+'" class="percent"></div>'+
									'<div class="indTpsContainer"><small>Tweets per sec: <span id="indTps'+(i+1)+'" class="indTps greenText"></span></small></div>'+
									'<div class="indRtpsContainer"><small>Retweets per sec: <span id="indRtps'+(i+1)+'" class="indRtps darkRedText"></span></small></div>'+
								'</div>'+
								'<div class="cardBottom">'+
									'<div class="indMostUsedWordsContanier smallFont justify blueText" id="indMostUsedWords'+(i+1)+'"></div>'+
									'<div class="keywordsContainer">'+
										'<span class="greenText">Keywords: </span><small class="lightGrayText">'+data.items[i].twSearch+'</small>'+
									'</div>'+
								'</div>'+
							'</div>';
					}
					totalArray[i] = data.items[i].total; 
					localData = data;
					percent = data.items[i].total.tweets/totalTweets * 100;
					document.getElementById("tweetNumber"+(i+1)).innerHTML = numberWithCommas(data.items[i].total.tweets);
					document.getElementById("retweetNumber"+(i+1)).innerHTML = numberWithCommas(data.items[i].total.retweets);
					document.getElementById("percent"+(i+1)).innerHTML = Math.floor(percent)+"%";
					if(data.items[i].mostUsedWords.words)
						document.getElementById("indMostUsedWords"+(i+1)).innerHTML = data.items[i].mostUsedWords.words.map(function(elem){return elem[0]}).join(' , ');
					if(loadOnce<data.items.length){
						document.getElementById("cardname"+(i+1)).innerHTML = data.items[i].name;
						document.getElementById("imgCard"+(i+1)).src = data.items[i].avatar;
						document.getElementById("date").innerHTML = moment(data.date).calendar();
						loadOnce ++;
					}
				}
				totalObject = data.total;
				document.getElementById("totalTweets").innerHTML = numberWithCommas(data.total.tweets);	
				document.getElementById("totalRetweets").innerHTML = numberWithCommas(data.total.retweets);	
				document.getElementById("totalCombined").innerHTML = numberWithCommas(data.total.retweets+data.total.tweets);
				if(data.words.words.length>0){
					document.getElementById("overallMostUsedWords").innerHTML = numberWithCommas(data.words.words.map(function(elem){return elem[0]}).join(' , '));	
					document.getElementById("overallMostUsedDate").innerHTML = moment(data.words.time).calendar();
				}
			});
		  
			setInterval(function(){
				if(localData){
					//This checks for overall tps
					lastTotalObject.tweets = lastTotalObject.tweets == 0 ? totalObject.tweets:lastTotalObject.tweets;
					document.getElementById("tps").innerHTML = "T/sec: "+(totalObject.tweets-lastTotalObject.tweets);	
					//End of overall tps checking
					
					//This checks for overall rtps
					lastTotalObject.retweets = lastTotalObject.retweets == 0 ? totalObject.retweets:lastTotalObject.retweets;
					document.getElementById("rtps").innerHTML = "RT/sec: "+(totalObject.retweets-lastTotalObject.retweets);	
					//End of overall rtps checking
					
					//This checks for overall combined Tps+Rtps
					document.getElementById("combinedTps").innerHTML = "T+RT/sec: "+((totalObject.retweets-lastTotalObject.retweets)+(totalObject.tweets-lastTotalObject.tweets));	
					//End of overall rtps checking
					
					lastTotalObject = totalObject;
					if(localData.items){
						for(var i = 0; i< localData.items.length; i++){
						  	//This checks for tps on each item
							if(!lastTotalArray[i]){
							  lastTotalArray[i] = {tweets:0,retweets:0};
							}
							if(lastTotalArray[i]){
								lastTotalArray[i].tweets = lastTotalArray[i].tweets == 0 ? totalArray[i].tweets:lastTotalArray[i].tweets;
								document.getElementById("indTps"+(i+1)).innerHTML = (totalArray[i].tweets-lastTotalArray[i].tweets);	
								document.getElementById("indRtps"+(i+1)).innerHTML = (totalArray[i].retweets-lastTotalArray[i].retweets);
								lastTotalArray[i] = totalArray[i];
							}
						  
						}
					}
				}
			}, 1000);
		  
		</script>
		<div id="bg"></div>
		<div class="title">
			<h1>People have <span class="blueText">tweeted</span> about</h1>
		</div>
		
		<div id="cardsContainer" class="cardsContainer"></div>
		<div class="mostUsedWordsContainer ">
			<div class="midFont bold darkGray">Most used words overall tweets</div>
			<div class="regularFont darkGray bold" id="overallMostUsedDate">Calculating..</div>
			<span class="pinkText italic" id="overallMostUsedWords"></span>
		</div>
		<div class="totalContainer">
			<div class="sectionContainer">
				<div class="totalTitleWrapper midBigFont">Total <span class="pinkText bold">Tweets</span>:</div>  
				<div class="totalNumberWrapper align-right pinkAnimation pinkText"><div class="bigFont bold" id="totalTweets"></div></div>
				<div class="totalTpsWrapper align-right tpsAnimation"><small><span class="regularFont grayText" id="tps">T/sec: 0</span></small></div>
			</div>
			
			<div class="sectionContainer">
				<div class="totalTitleWrapper midBigFont">Total <span class="blueText bold">Retweets</span>:</div>  
				<div class="totalNumberWrapper align-right blueAnimation blueText"><span class="bigFont bold" id="totalRetweets"></span></div>
				<div class="totalTpsWrapper align-right tpsAnimation"><small><span class="regularFont grayText" id="rtps">RT/sec: 0</span></small></div>
			</div>
			
			<div class="sectionContainer">
				<div class="totalTitleWrapper midBigFont">Total <span class="greenText bold">Combined</span>:</div>  
				<div class="totalNumberWrapper align-right greenAnimation greenText"><span class="bigFont bold" id="totalCombined"></span></div>
				<div class="totalTpsWrapper align-right tpsAnimation"><small><span class="regularFont grayText" id="combinedTps">T+RT/sec: 0</span></small></div>
			</div>
		</div>
		<div class="bottom">
			<h1>Since: <b id="date"></b></h1>
		</div>
	
	</body>
</html>